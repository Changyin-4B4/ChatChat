# ChatChat

一个面向可成长 AI 角色扮演（AIRP）的"逻辑与创作分离"状态引擎。

**起初，我只是觉得：混杂大量类似代码和文字的提示词很玄学。**

---

## 为什么需要它？

你是否遇到过这些问题：

* 角色一本正经算错数学（例如 102 < 100）？
* 角色突然"背诵"后台数据（例如"我现在处于 xx 阶段"）？
* GUI 状态栏因 AI 忘记特定字符串而消失？

 **本项目不是普通的聊天界面** 。它通过彻底分离创作与变量更新的提示词，提供更高质量的文字和更新结果。

---

## 核心特性

### 1. 创作与判断逻辑分离

* **Pre-Update** ：只分析用户输入，更新客观状态（如时间）
* **Post-Update** ：只分析 AI 创作，更新主观状态（如好感度）
* **交互模式** ：Pre-Update 可分析用户输入对剧情的影响，变化立即体现在 AI 回复中

### 2. LLM 抽象层

* 支持为 Pre-Judge、Creator、Post-Judge 分别指定不同的 LLM
* 灵活配置模型组合，性能与成本自由平衡

### 3. 动态 Prompt 编译器

* **级联变量** ：支持 `(60, 60, 24, 30, 12)` 这样的多级时钟变量
* **多重绑定** ：自动处理"乘法"（如 `[[好感度, 饥饿]]`）与"加法"（如 `[日期]`）的提示词注入
* **两阶段渲染** ：允许在 txt 文件中使用 `{变量.description}` 自填充，避免为简单内容编写大量文件

---

## GUI 仪表盘（PySide6）

### 布局

* **上半区（切换）** ：立绘（预留）或 运行日志（Token 消耗、finish_reason）
* **下半区（切换）** ：变量仪表盘（进度条与数值）或 幕后区（reasoning_content 流式显示）

### 模块化 Reroll

* **五个独立命令** ：Send、Reroll Pre、Reroll Create、Reroll Post、Delete
* **智能按钮管理** ：自动检测 data.json 状态，禁用非法操作（例如 Pre 未完成时不能 Reroll Post）
* **崩溃恢复** ：自动检测半成品条目，静默禁用 Send，引导用户 Reroll 或 Delete

### 中断机制

* **Pause（中断）** → 自动执行 UI 回滚，保持数据一致性

---

## 快速开始

1. 下载并解压 Release 中的 exe 压缩包（PyInstaller 打包，可能被杀毒软件误报）
2. 运行程序，选择卡片文件夹
3. 确保卡片文件夹配置正确（参考 `docs/card_folder_guide.md`）

 **注意** ：首次运行时请关注杀毒软件提示，程序未签名可能触发安全警告。

---

## 开发说明

面向 AI 的编程 —— 95% 的代码由各种 Copilot 完成，我只负责想法。

---

## 文档

* `使用说明.md` - 卡片文件夹配置说明
* `core_configs_guide.md` - 核心配置指南
* `variables_config_guide.md` - 变量系统配置
* `Cycle_guide.md` - 针对循环式变量的额外说明
* `prompts_config_guide.md` - 提示词配置
* `update&reset_guide.md` - LLM 判断任务配置
* `variables_keyword_guide.md` - 关键词更新配置

---

## 许可证

[待添加]

---

## 致谢

* 默认创作提示词模板来源于 Discord 类脑社区 - haruki（鲸鱼娘与金阁寺），已做微调
