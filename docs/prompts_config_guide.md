# Prompts é…ç½®æŒ‡å—ï¼ˆprompts_config.jsonï¼‰

æœ¬æ–‡ä»¶è¯´æ˜å¦‚ä½•åœ¨ `prompts_config.json` ä¸­é…ç½®æç¤ºè¯ç³»ç»Ÿï¼ŒåŒ…æ‹¬ç®€å•æç¤ºè¯ï¼ˆsimpleï¼‰å’Œå¤æ‚æç¤ºè¯ï¼ˆcomplexï¼‰çš„è®¾ç½®ã€‚

## æ–‡ä»¶æ¦‚è¿°

* **æ–‡ä»¶å** ï¼š`prompts_config.json`
* **ç”¨é€”** ï¼šæ§åˆ¶ LLM æç¤ºè¯çš„åŠ¨æ€åŠ è½½ã€æ¡ä»¶æ˜¾ç¤ºå’Œé˜¶æ®µå˜åŒ–
* **é¡¶å±‚ç»“æ„** ï¼šåŒ…å«ä¸¤ä¸ªä¸»è¦ä½ç½®æ§½ä½ `position_0` å’Œ `position_1`

```json
{
  "position_0": { /* ä½ç½® 0 çš„é…ç½® */ },
  "position_1": { /* ä½ç½® 1 çš„é…ç½® */ }
}
```

---

## æ ¸å¿ƒæ¦‚å¿µ

### ä½ç½®æ§½ä½ï¼ˆPositionï¼‰

* **position_0** ï¼šç¬¬ä¸€ä¸ªæç¤ºè¯æ’å…¥ä½ç½®
* **position_1** ï¼šç¬¬äºŒä¸ªæç¤ºè¯æ’å…¥ä½ç½®

æ¯ä¸ªä½ç½®æ§½ä½åŒ…å«ä¸¤ç±»é…ç½®ï¼š

* **simple** ï¼šç®€å•æç¤ºè¯ï¼ˆé™æ€æ–‡ä»¶ï¼Œæ”¯æŒå…³é”®è¯è§¦å‘ï¼‰
* **complex** ï¼šå¤æ‚æç¤ºè¯ï¼ˆåŸºäºå˜é‡é˜¶æ®µåŠ¨æ€ç”Ÿæˆï¼‰

---

## Simple é…ç½®ï¼ˆç®€å•æç¤ºè¯ï¼‰

### åŸºæœ¬ç»“æ„

```json
"simple": {
  "simple_info_1": {
    "keywords": [],
    "depth": 0,
    "file": "information/worldview.txt"
  }
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ         | ç±»å‹   | å¿…å¡« | è¯´æ˜                                                                     |
| ------------ | ------ | ---- | ------------------------------------------------------------------------ |
| `keywords` | array  | å¦   | å…³é”®è¯åˆ—è¡¨ã€‚ä¸ºç©ºæ—¶æ€»æ˜¯åŠ è½½ï¼›ä¸ä¸ºç©ºæ—¶ä»…åœ¨å†å²è®°å½•ä¸­åŒ¹é…åˆ°ä»»ä¸€å…³é”®è¯æ‰åŠ è½½ |
| `depth`    | int    | æ˜¯   | æ·±åº¦çº§åˆ«ï¼ˆ0, 1, 2...ï¼‰ã€‚æ§åˆ¶æç¤ºè¯åŠ è½½çš„ä¼˜å…ˆçº§å±‚çº§                       |
| `file`     | string | æ˜¯   | æ–‡æœ¬æ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹äºå·¥ä½œç›®å½•ï¼‰ã€‚ä¸ºç©ºå­—ç¬¦ä¸²æ—¶è·³è¿‡è¯¥é…ç½®é¡¹                 |

### ä½¿ç”¨åœºæ™¯

**1. æ— æ¡ä»¶åŠ è½½ï¼ˆåŸºç¡€è®¾å®šï¼‰**

```json
"simple_info_base": {
  "keywords": [],
  "depth": 0,
  "file": "information/worldview.txt"
}
```

* ä¸æ£€æŸ¥å…³é”®è¯ï¼Œæ€»æ˜¯åŠ è½½
* é€‚ç”¨äºä¸–ç•Œè§‚ã€è§’è‰²å¡ç­‰åŸºç¡€ä¿¡æ¯

**2. å…³é”®è¯è§¦å‘åŠ è½½ï¼ˆæ¡ä»¶è®¾å®šï¼‰**

```json
"simple_info_event": {
  "keywords": ["æˆ˜æ–—", "é­”æ³•"],
  "depth": 1,
  "file": "information/combat_rules.txt"
}
```

* ä»…å½“å†å²è®°å½•åŒ…å«"æˆ˜æ–—"æˆ–"é­”æ³•"æ—¶åŠ è½½
* é€‚ç”¨äºç‰¹å®šåœºæ™¯çš„è¡¥å……è§„åˆ™

### æ³¨æ„äº‹é¡¹

* âœ… æ–‡ä»¶ä¸å­˜åœ¨æˆ–å†…å®¹ä¸ºç©ºæ—¶è‡ªåŠ¨è·³è¿‡ï¼Œä¸ä¼šæŠ¥é”™
* âœ… åŒä¸€ `depth` ä¸‹çš„å¤šä¸ªé…ç½®é¡¹ä¼šæŒ‰é…ç½®é¡ºåºæ‹¼æ¥
* âŒ `file` å­—æ®µä¸ºç©ºå­—ç¬¦ä¸²æ—¶ä¸ä¼šè¯»å–æ–‡ä»¶
* âŒ å…³é”®è¯åŒ¹é…å¤§å°å†™æ•æ„Ÿ

---

## Complex é…ç½®ï¼ˆå¤æ‚æç¤ºè¯ï¼‰

### åŸºæœ¬ç»“æ„

```json
"complex": {
  "complex_info_1": {
    "keywords": [],
    "depth": 0,
    "base_file": "information/complex_info1_base.txt",
    "variable_binding": "å¥½æ„Ÿåº¦",
    "variable_binding_method": [0],
    "stages": {
      "part_0": {
        "stage_0": "information/stage1.txt",
        "stage_1": "information/stage2.txt"
      }
    }
  }
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ                        | ç±»å‹         | å¿…å¡« | è¯´æ˜                                        |
| --------------------------- | ------------ | ---- | ------------------------------------------- |
| `keywords`                | array        | å¦   | å…³é”®è¯è§¦å‘æ¡ä»¶ï¼ˆåŒ simpleï¼‰                 |
| `depth`                   | int          | æ˜¯   | æ·±åº¦çº§åˆ«ï¼ˆåŒ simpleï¼‰                       |
| `base_file`               | string       | å¦   | åŸºç¡€æ–‡æœ¬æ–‡ä»¶è·¯å¾„ã€‚ä¸éšå˜é‡å˜åŒ–ï¼Œå§‹ç»ˆåŠ è½½    |
| `variable_binding`        | string/array | æ˜¯   | ç»‘å®šçš„å˜é‡åç§°ï¼ˆå•ä¸ªæˆ–å¤šä¸ªï¼‰                |
| `variable_binding_method` | array        | æ˜¯   | å˜é‡å€¼çš„ç»„åˆæ–¹å¼ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰                |
| `stages`                  | object       | æ˜¯   | é˜¶æ®µé…ç½®ã€‚é”®ä¸º `part_X`ï¼Œå€¼ä¸ºé˜¶æ®µæ–‡ä»¶æ˜ å°„ |

---

## Variable Bindingï¼ˆå˜é‡ç»‘å®šï¼‰

### å•å˜é‡ç»‘å®š

**ç¤ºä¾‹ï¼šå¥½æ„Ÿåº¦é˜¶æ®µ**

```json
"variable_binding": "å¥½æ„Ÿåº¦",
"variable_binding_method": [0]
```

**è§£é‡Šï¼š**

* ç»‘å®šå•ä¸ªå˜é‡ `å¥½æ„Ÿåº¦`
* `[0]` è¡¨ç¤ºä½¿ç”¨è¯¥å˜é‡çš„ `relative_value` ç´¢å¼• 0
* å¦‚æœå¥½æ„Ÿåº¦é˜¶æ®µå€¼ä¸º 2ï¼Œåˆ™è¯»å– `stages.part_0.stage_2`

### å¤šå˜é‡ç»‘å®š

**ç¤ºä¾‹ï¼šå¥½æ„Ÿåº¦ + é¥¥é¥¿åº¦ç»„åˆ**

```json
"variable_binding": ["å¥½æ„Ÿåº¦", "é¥¥é¥¿åº¦"],
"variable_binding_method": [[0, 1]]
```

**è§£é‡Šï¼š**

* ç»‘å®šä¸¤ä¸ªå˜é‡
* `[[0, 1]]` è¡¨ç¤ºå°†ä¸¤ä¸ªå˜é‡çš„å€¼ç»„åˆ
* å¦‚æœå¥½æ„Ÿåº¦=1ï¼Œé¥¥é¥¿åº¦=2ï¼Œåˆ™è¯»å– `stages.part_0.stage_1_2`

---

## Variable Binding Methodï¼ˆç»„åˆæ–¹å¼ï¼‰

### é‡è¦æ¦‚å¿µï¼šæ€»ç´¢å¼•ï¼ˆGlobal Indexï¼‰

 **å…³é”®è§„åˆ™** ï¼š`variable_binding_method` ä¸­çš„æ•°å­—æŒ‡çš„æ˜¯ **æ‰€æœ‰ç»‘å®šå˜é‡å±•å¼€åçš„æ€»ç´¢å¼•** ï¼Œè€Œéå˜é‡åºå·ï¼

#### æ€»ç´¢å¼•çš„è®¡ç®—æ–¹å¼

å¯¹äº `variable_binding` ä¸­çš„å¤šä¸ªå˜é‡ï¼ŒæŒ‰é¡ºåºå±•å¼€å®ƒä»¬çš„ `relative_value`ï¼š

 **è§„åˆ™** ï¼š

* **LADDER å˜é‡** ï¼šè¿”å›å•ä¸ªæ•´æ•° â†’ å ç”¨ 1 ä¸ªç´¢å¼•
* **CYCLE å˜é‡ï¼ˆN=2ï¼‰** ï¼šè¿”å›å•ä¸ªæ•´æ•° â†’ å ç”¨ 1 ä¸ªç´¢å¼•
* **CYCLE å˜é‡ï¼ˆN>2ï¼‰** ï¼šè¿”å› `(N-1)` ä¸ªæ•´æ•°çš„å…ƒç»„ â†’ å ç”¨ `(N-1)` ä¸ªç´¢å¼•

 **ç¤ºä¾‹** ï¼š

```json
"variable_binding": ["å¥½æ„Ÿåº¦", "æ—¥æœŸ", "é¥¥é¥¿åº¦"]
```

å‡è®¾ï¼š

* `å¥½æ„Ÿåº¦`ï¼ˆLADDERï¼‰ï¼š`relative_value = 1` â†’ å ç´¢å¼• **[0]**
* `æ—¥æœŸ`ï¼ˆCYCLEï¼ŒN=5ï¼‰ï¼š`relative_value = (2, 15, 1, 3)` â†’ å ç´¢å¼• **[1, 2, 3, 4]**
* `é¥¥é¥¿åº¦`ï¼ˆLADDERï¼‰ï¼š`relative_value = 2` â†’ å ç´¢å¼• **[5]**

 **æ€»ç´¢å¼•æ˜ å°„è¡¨** ï¼š

| æ€»ç´¢å¼• | å˜é‡    | å«ä¹‰         |
| ------ | ------- | ------------ |
| 0      | å¥½æ„Ÿåº¦  | å¥½æ„Ÿåº¦é˜¶æ®µå€¼ |
| 1      | æ—¥æœŸ[0] | æœˆä»½         |
| 2      | æ—¥æœŸ[1] | æ—¥æœŸ         |
| 3      | æ—¥æœŸ[2] | æ—¬           |
| 4      | æ—¥æœŸ[3] | æ—¶æ®µ         |
| 5      | é¥¥é¥¿åº¦  | é¥¥é¥¿åº¦é˜¶æ®µå€¼ |

### è¯­æ³•è§„åˆ™

* **å¹¶åˆ—å…³ç³»** ï¼š`[0, 1, 2]` â†’ åˆ†åˆ«ä½¿ç”¨æ€»ç´¢å¼• 0ã€1ã€2 çš„å€¼
* **ç»‘å®šå…³ç³»** ï¼š`[[0, 1]]` â†’ ç»„åˆæ€»ç´¢å¼• 0 å’Œ 1 çš„å€¼
* **æ··åˆå…³ç³»** ï¼š`[[0, 1], 2]` â†’ æ€»ç´¢å¼• 0ã€1 ç»„åˆï¼Œæ€»ç´¢å¼• 2 ç‹¬ç«‹

### ç¤ºä¾‹ 1ï¼šè·¨å˜é‡ç»„åˆï¼ˆç»‘å®šï¼‰

```json
"variable_binding": ["å¥½æ„Ÿåº¦", "æ—¥æœŸ", "é¥¥é¥¿åº¦"],
"variable_binding_method": [[0, 1]]
```

 **è§£é‡Š** ï¼š

* æ€»ç´¢å¼• 0 = å¥½æ„Ÿåº¦
* æ€»ç´¢å¼• 1 = æ—¥æœŸçš„æœˆä»½
* ç»„åˆåè¯»å– `stage_{å¥½æ„Ÿåº¦}_{æœˆä»½}`

 **å‡è®¾å€¼** ï¼šå¥½æ„Ÿåº¦=1ï¼Œæœˆä»½=2

* è¯»å– `stages.part_0.stage_1_2`

### ç¤ºä¾‹ 2ï¼šæ—¶é—´ç³»ç»Ÿï¼ˆå¹¶åˆ—è·³è·ƒï¼‰

```json
"variable_binding": "æ—¥æœŸ",
"variable_binding_method": [0, 3]
```

 **å‡è®¾** ï¼š`æ—¥æœŸ` çš„ `relative_stage_config = [1440, 30, 12]`ï¼ˆåˆ†é’Ÿ-å¤©-æœˆï¼‰

* è¿”å› `relative_value = (2, 15)`ï¼ˆæœˆä»½ç´¢å¼•2, å¤©æ•°ç´¢å¼•15ï¼‰
* æ€»ç´¢å¼• 0 = æœˆä»½ï¼ˆ2ï¼‰
* æ€»ç´¢å¼• 1 = å¤©æ•°ï¼ˆ15ï¼‰

 **é…ç½®ä½¿ç”¨** ï¼š

* `part_0` ä½¿ç”¨æ€»ç´¢å¼• 0 â†’ `stage_2`ï¼ˆ3æœˆï¼‰
* `part_1` ä½¿ç”¨æ€»ç´¢å¼• 3 â†’ **è¶Šç•Œé”™è¯¯ï¼** âŒ

 **æ­£ç¡®å†™æ³•** ï¼š

```json
"variable_binding_method": [0, 1]
```

* `part_0` â†’ `stage_2`ï¼ˆ3æœˆï¼‰
* `part_1` â†’ `stage_15`ï¼ˆ15æ—¥ï¼‰

### ç¤ºä¾‹ 3ï¼šå¤æ‚æ—¶é—´ç³»ç»Ÿï¼ˆå¹¶åˆ—ï¼‰

```json
"variable_binding": "æ—¥æœŸ",
"variable_binding_method": [0, 2, 3]
```

 **å‡è®¾** ï¼š`æ—¥æœŸ` çš„ `relative_stage_config = [360, 4, 10, 3, 12]`ï¼ˆåˆ†é’Ÿ-æ—¶æ®µ-å¤©-æ—¬-æœˆï¼‰

* è¿”å› `relative_value = (2, 1, 5, 2)`ï¼ˆæœˆ-æ—¬-å¤©-æ—¶æ®µï¼Œå€’åºï¼‰
* æ€»ç´¢å¼•æ˜ å°„ï¼š
  * 0 â†’ æœˆä»½ï¼ˆ2ï¼‰
  * 1 â†’ æ—¬ï¼ˆ1ï¼‰
  * 2 â†’ å¤©æ•°ï¼ˆ5ï¼‰
  * 3 â†’ æ—¶æ®µï¼ˆ2ï¼‰

 **é…ç½®ä½¿ç”¨** ï¼š

* `part_0` ä½¿ç”¨æ€»ç´¢å¼• 0 â†’ `stage_2`ï¼ˆ3æœˆï¼‰
* `part_1` ä½¿ç”¨æ€»ç´¢å¼• 2 â†’ `stage_5`ï¼ˆ6å¤©ï¼‰
* `part_2` ä½¿ç”¨æ€»ç´¢å¼• 3 â†’ `stage_2`ï¼ˆä¸‹åˆï¼‰

### ç¤ºä¾‹ 4ï¼šæ··åˆå˜é‡ï¼ˆæ··åˆå…³ç³»ï¼‰

```json
"variable_binding": ["å¥½æ„Ÿåº¦", "æ—¥æœŸ", "é¥¥é¥¿åº¦"],
"variable_binding_method": [[0, 1], 5]
```

 **å‡è®¾å€¼** ï¼š

* å¥½æ„Ÿåº¦=1ï¼ˆæ€»ç´¢å¼•0ï¼‰
* æ—¥æœŸ=(2,15,1,3)ï¼ˆæ€»ç´¢å¼•1-4ï¼‰
* é¥¥é¥¿åº¦=2ï¼ˆæ€»ç´¢å¼•5ï¼‰

 **é…ç½®ä½¿ç”¨** ï¼š

* `part_0` ç»‘å®šæ€»ç´¢å¼• 0 å’Œ 1 â†’ `stage_1_2`ï¼ˆå¥½æ„Ÿ1 + æœˆä»½2ï¼‰
* `part_1` ä½¿ç”¨æ€»ç´¢å¼• 5 â†’ `stage_2`ï¼ˆé¥¥é¥¿åº¦2ï¼‰

### å¸¸è§é”™è¯¯ï¼šç´¢å¼•è¶Šç•Œ

âŒ  **é”™è¯¯ç¤ºä¾‹** ï¼š

```json
"variable_binding": ["å¥½æ„Ÿåº¦", "é¥¥é¥¿åº¦"],
"variable_binding_method": [0, 1, 2]
```

 **é—®é¢˜** ï¼šæ€»ç´¢å¼•åªæœ‰ 0 å’Œ 1ï¼Œä½†ä½¿ç”¨äº†ç´¢å¼• 2ï¼

âœ“  **æ­£ç¡®ç¤ºä¾‹** ï¼š

```json
"variable_binding_method": [0, 1]
```

æˆ–è€…ç»‘å®šä½¿ç”¨ï¼š

```json
"variable_binding_method": [[0, 1]]
```

---

## Stages é…ç½®ï¼ˆé˜¶æ®µæ–‡ä»¶æ˜ å°„ï¼‰

### å•å˜é‡é˜¶æ®µ

```json
"stages": {
  "part_0": {
    "stage_0": "information/stage_stranger.txt",
    "stage_1": "information/stage_familiar.txt",
    "stage_2": "information/stage_close.txt"
  }
}
```

### å¤šå˜é‡ç»„åˆé˜¶æ®µ

```json
"stages": {
  "part_0": {
    "stage_0_0": "information/stage_low_low.txt",
    "stage_0_1": "information/stage_low_mid.txt",
    "stage_1_0": "information/stage_mid_low.txt",
    "stage_1_1": "information/stage_mid_mid.txt"
  }
}
```

 **å‘½åè§„åˆ™** ï¼š

* å•å˜é‡ï¼š`stage_{value}`
* åŒå˜é‡ï¼š`stage_{value1}_{value2}`
* ä¸‰å˜é‡ï¼š`stage_{value1}_{value2}_{value3}`

---

## é˜¶æ®µå˜åŒ–æç¤ºï¼ˆrelative_is_upgradeï¼‰

å½“å˜é‡çš„ `relative_is_upgrade` ä¸ä¸ºç©ºæ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆå˜åŒ–æç¤ºè¯ã€‚

### å››ç§æƒ…å†µ

#### 1. æ–°æ—§å†…å®¹éƒ½å­˜åœ¨ä¸”ä¸åŒ

```
ã€å˜åŒ–æç¤ºã€‘
æ³¨æ„ï¼Œä»
{æ—§å†…å®¹}
å˜ä¸ºäº†
{æ–°å†…å®¹}
è¯·åœ¨åˆ›ä½œæ—¶å¯¹å˜åŒ–åŠ ä»¥æè¿°ã€‚
```

#### 2. æ–°å†…å®¹å­˜åœ¨ï¼Œæ—§å†…å®¹ä¸ºç©ºï¼ˆæ–°å¢è®¾å®šï¼‰

```
ã€å˜åŒ–æç¤ºã€‘
æ³¨æ„ï¼Œæ–°å¢äº†ä»¥ä¸‹è®¾å®šï¼š
{æ–°å†…å®¹}
è¯·åœ¨åˆ›ä½œæ—¶å¯¹å˜åŒ–åŠ ä»¥æè¿°ã€‚
```

#### 3. æ—§å†…å®¹å­˜åœ¨ï¼Œæ–°å†…å®¹ä¸ºç©ºï¼ˆè®¾å®šåºŸé™¤ï¼‰

```
ã€å˜åŒ–æç¤ºã€‘
æ³¨æ„ï¼Œä»¥ä¸‹è®¾å®šå·²åºŸé™¤ï¼š
{æ—§å†…å®¹}
è¯·åœ¨åˆ›ä½œæ—¶å¯¹å˜åŒ–åŠ ä»¥æè¿°ã€‚
```

#### 4. æ–°æ—§å†…å®¹ç›¸åŒæˆ–éƒ½ä¸ºç©º

* ä¸ç”Ÿæˆå˜åŒ–æç¤º

---

## å ä½ç¬¦æ›¿æ¢ï¼ˆï¼‰

åœ¨ complex é…ç½®çš„æ–‡ä»¶å†…å®¹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å ä½ç¬¦å¼•ç”¨å˜é‡çš„æè¿°æ–‡æœ¬ã€‚

### âš ï¸ é‡è¦è§„åˆ™ï¼šå ä½ç¬¦ä½¿ç”¨æ€»ç´¢å¼•

 **å…³é”®** ï¼š`{element_n}` ä¸­çš„ `n` ä½¿ç”¨çš„æ˜¯ **æ€»ç´¢å¼•** ï¼Œä¸ `variable_binding_method` å®Œå…¨ä¸€è‡´ï¼

è¿™æ„å‘³ç€ä½ å¿…é¡»æ¸…æ¥šåœ°çŸ¥é“ï¼š

1. æ¯ä¸ªå˜é‡å ç”¨å¤šå°‘ä¸ªæ€»ç´¢å¼•
2. å ä½ç¬¦å¯¹åº”å“ªä¸ªå˜é‡çš„å“ªä¸ªéƒ¨åˆ†

### è¯­æ³•

```
{element_0}, {element_1}, {element_2}, ...
```

### æ›¿æ¢è§„åˆ™

å ä½ç¬¦æŒ‰ç…§ `variable_binding` é¡ºåºå’Œ `relative_current_description` å±•å¼€åçš„**æ€»ç´¢å¼•**å¯¹åº”ï¼š

**ç¤ºä¾‹ 1ï¼šå•å˜é‡ï¼ˆLADDERï¼‰**

```json
"variable_binding": "å¥½æ„Ÿåº¦"
```

å‡è®¾å¥½æ„Ÿåº¦çš„ `relative_current_description` ä¸º `"ç†Ÿæ‚‰"`ï¼š

* æ€»ç´¢å¼• 0 â†’ `"ç†Ÿæ‚‰"`
* `{element_0}` â†’ `"ç†Ÿæ‚‰"`

---

**ç¤ºä¾‹ 2ï¼šå¤šå˜é‡ï¼ˆéƒ½æ˜¯ LADDERï¼‰**

```json
"variable_binding": ["å¥½æ„Ÿåº¦", "é¥¥é¥¿åº¦"]
```

å‡è®¾ï¼š

* å¥½æ„Ÿåº¦ï¼š`"ç†Ÿæ‚‰"`ï¼ˆæ€»ç´¢å¼• 0ï¼‰
* é¥¥é¥¿åº¦ï¼š`"é¥¥é¥¿"`ï¼ˆæ€»ç´¢å¼• 1ï¼‰

åˆ™ï¼š

* `{element_0}` â†’ `"ç†Ÿæ‚‰"`
* `{element_1}` â†’ `"é¥¥é¥¿"`

---

**ç¤ºä¾‹ 3ï¼šCYCLE å˜é‡ï¼ˆå…ƒç»„å±•å¼€ï¼‰**

```json
"variable_binding": "æ—¥æœŸ"
```

å‡è®¾æ—¥æœŸçš„ `relative_current_description` ä¸º `("ä¸‰æœˆ", "15æ—¥", "ä¸­æ—¬", "ä¸‹åˆ")`ï¼š

* æ€»ç´¢å¼• 0 â†’ `"ä¸‰æœˆ"`
* æ€»ç´¢å¼• 1 â†’ `"15æ—¥"`
* æ€»ç´¢å¼• 2 â†’ `"ä¸­æ—¬"`
* æ€»ç´¢å¼• 3 â†’ `"ä¸‹åˆ"`

åˆ™ï¼š

* `{element_0}` â†’ `"ä¸‰æœˆ"`
* `{element_1}` â†’ `"15æ—¥"`
* `{element_2}` â†’ `"ä¸­æ—¬"`
* `{element_3}` â†’ `"ä¸‹åˆ"`

---

**ç¤ºä¾‹ 4ï¼šæ··åˆå˜é‡ï¼ˆLADDER + CYCLE + LADDERï¼‰âš ï¸**

```json
"variable_binding": ["å¥½æ„Ÿåº¦", "æ—¥æœŸ", "é¥¥é¥¿åº¦"]
```

å‡è®¾ï¼š

* å¥½æ„Ÿåº¦ï¼ˆLADDERï¼‰ï¼š`"ç†Ÿæ‚‰"` â†’ æ€»ç´¢å¼• **[0]**
* æ—¥æœŸï¼ˆCYCLEï¼ŒN=5ï¼‰ï¼š`("ä¸‰æœˆ", "15æ—¥", "ä¸­æ—¬", "ä¸‹åˆ")` â†’ æ€»ç´¢å¼• **[1, 2, 3, 4]**
* é¥¥é¥¿åº¦ï¼ˆLADDERï¼‰ï¼š`"é¥¥é¥¿"` â†’ æ€»ç´¢å¼• **[5]**

 **æ€»ç´¢å¼•æ˜ å°„è¡¨** ï¼š

| æ€»ç´¢å¼• | å˜é‡    | æè¿°å€¼ |
| ------ | ------- | ------ |
| 0      | å¥½æ„Ÿåº¦  | "ç†Ÿæ‚‰" |
| 1      | æ—¥æœŸ[0] | "ä¸‰æœˆ" |
| 2      | æ—¥æœŸ[1] | "15æ—¥" |
| 3      | æ—¥æœŸ[2] | "ä¸­æ—¬" |
| 4      | æ—¥æœŸ[3] | "ä¸‹åˆ" |
| 5      | é¥¥é¥¿åº¦  | "é¥¥é¥¿" |

 **å ä½ç¬¦æ›¿æ¢** ï¼š

* `{element_0}` â†’ `"ç†Ÿæ‚‰"`
* `{element_1}` â†’ `"ä¸‰æœˆ"`
* `{element_2}` â†’ `"15æ—¥"`
* `{element_3}` â†’ `"ä¸­æ—¬"`
* `{element_4}` â†’ `"ä¸‹åˆ"`
* `{element_5}` â†’ `"é¥¥é¥¿"`

---

### æ–‡ä»¶å†…å®¹ç¤ºä¾‹

 **æ–‡ä»¶** ï¼š`information/complex_status_base.txt`

```
å½“å‰æ—¶é—´ä¸º{element_1}{element_2}{element_4}ï¼Œå…³ç³»çŠ¶æ€ä¸º{element_0}ï¼Œé¥¥é¥¿ç¨‹åº¦ä¸º{element_5}ã€‚
```

 **æ¸²æŸ“å** ï¼ˆä½¿ç”¨ä¸Šé¢çš„ç¤ºä¾‹ 4 æ•°æ®ï¼‰ï¼š

```
å½“å‰æ—¶é—´ä¸ºä¸‰æœˆ15æ—¥ä¸‹åˆï¼Œå…³ç³»çŠ¶æ€ä¸ºç†Ÿæ‚‰ï¼Œé¥¥é¥¿ç¨‹åº¦ä¸ºé¥¥é¥¿ã€‚
```

---

### âš ï¸ å¸¸è§é”™è¯¯ï¼šç´¢å¼•é”™ä½

#### é”™è¯¯ç¤ºä¾‹ 1ï¼šè¯¯ç”¨å˜é‡åºå·

âŒ  **é”™è¯¯ç†è§£** ï¼š

```json
"variable_binding": ["å¥½æ„Ÿåº¦", "æ—¥æœŸ", "é¥¥é¥¿åº¦"]
```

```
å½“å‰å…³ç³»ä¸º{element_0}ï¼Œæ—¶é—´ä¸º{element_1}ï¼Œé¥¥é¥¿åº¦ä¸º{element_2}
```

 **é—®é¢˜** ï¼šè®¤ä¸º `{element_1}` æ˜¯"æ—¥æœŸ"ï¼Œä½†å®é™…ä¸Š `{element_1}` æ˜¯æ—¥æœŸçš„ **ç¬¬ä¸€ä¸ªç´¢å¼•** ï¼ˆæœˆä»½ï¼‰ï¼

âœ“  **æ­£ç¡®å†™æ³•** ï¼š

```
å½“å‰å…³ç³»ä¸º{element_0}ï¼Œæ—¶é—´ä¸º{element_1}{element_2}{element_4}ï¼Œé¥¥é¥¿åº¦ä¸º{element_5}
```

---

#### é”™è¯¯ç¤ºä¾‹ 2ï¼šå¿˜è®° CYCLE å˜é‡å ç”¨å¤šä¸ªç´¢å¼•

âŒ  **é”™è¯¯é…ç½®** ï¼š

```json
"variable_binding": ["æ—¥æœŸ", "é¥¥é¥¿åº¦"]
```

```
æ—¥æœŸï¼š{element_0}ï¼Œé¥¥é¥¿åº¦ï¼š{element_1}
```

 **é—®é¢˜** ï¼šå‡è®¾æ—¥æœŸè¿”å› 4 ä¸ªå€¼ `(æœˆ, æ—¥, æ—¬, æ—¶æ®µ)`ï¼š

* `{element_1}` å®é™…æ˜¯"æ—¥æœŸ"ï¼ˆæ—¥æœŸçš„ç¬¬ 2 ä¸ªç´¢å¼•ï¼‰
* é¥¥é¥¿åº¦åº”è¯¥æ˜¯ `{element_4}`ï¼

âœ“  **æ­£ç¡®å†™æ³•** ï¼š

```
æ—¥æœŸï¼š{element_0}{element_1}ï¼Œé¥¥é¥¿åº¦ï¼š{element_4}
```

æˆ–è€…åªç”¨æœˆä»½å’Œæ—¶æ®µï¼š

```
{element_0}{element_3}ï¼Œé¥¥é¥¿åº¦ä¸º{element_4}
```

---

### ğŸ’¡ å®ç”¨å»ºè®®ï¼šåˆ›å»ºç´¢å¼•æ˜ å°„è¡¨

åœ¨ç¼–å†™å¤æ‚é…ç½®æ—¶ï¼Œ **å¼ºçƒˆå»ºè®®å…ˆåˆ—å‡ºæ€»ç´¢å¼•æ˜ å°„è¡¨** ï¼

#### æ­¥éª¤ 1ï¼šåˆ—å‡ºå˜é‡å’Œè¿”å›å€¼

```json
"variable_binding": ["å¥½æ„Ÿåº¦", "æ—¥æœŸ", "ä½“åŠ›", "é¥¥é¥¿åº¦"]
```

 **å‡è®¾è¿”å›å€¼** ï¼š

* å¥½æ„Ÿåº¦ï¼ˆLADDERï¼‰ï¼š1
* æ—¥æœŸï¼ˆCYCLEï¼ŒN=5ï¼‰ï¼š(2, 15, 1, 3)
* ä½“åŠ›ï¼ˆLADDERï¼‰ï¼š80
* é¥¥é¥¿åº¦ï¼ˆLADDERï¼‰ï¼š2

 **å‡è®¾æè¿°** ï¼š

* å¥½æ„Ÿåº¦ï¼š`"ç†Ÿæ‚‰"`
* æ—¥æœŸï¼š`("ä¸‰æœˆ", "15æ—¥", "ä¸­æ—¬", "ä¸‹åˆ")`
* ä½“åŠ›ï¼š`"å……æ²›"`
* é¥¥é¥¿åº¦ï¼š`"é¥¥é¥¿"`

#### æ­¥éª¤ 2ï¼šåˆ¶ä½œæ€»ç´¢å¼•æ˜ å°„è¡¨

| æ€»ç´¢å¼• | å˜é‡    | å€¼ | æè¿°   | å ä½ç¬¦          |
| ------ | ------- | -- | ------ | --------------- |
| 0      | å¥½æ„Ÿåº¦  | 1  | "ç†Ÿæ‚‰" | `{element_0}` |
| 1      | æ—¥æœŸ[0] | 2  | "ä¸‰æœˆ" | `{element_1}` |
| 2      | æ—¥æœŸ[1] | 15 | "15æ—¥" | `{element_2}` |
| 3      | æ—¥æœŸ[2] | 1  | "ä¸­æ—¬" | `{element_3}` |
| 4      | æ—¥æœŸ[3] | 3  | "ä¸‹åˆ" | `{element_4}` |
| 5      | ä½“åŠ›    | 80 | "å……æ²›" | `{element_5}` |
| 6      | é¥¥é¥¿åº¦  | 2  | "é¥¥é¥¿" | `{element_6}` |

#### æ­¥éª¤ 3ï¼šç¼–å†™æ–‡ä»¶å†…å®¹

æœ‰äº†æ˜ å°„è¡¨ï¼Œå°±èƒ½å‡†ç¡®ä½¿ç”¨å ä½ç¬¦ï¼š

```
æ—¶é—´ï¼š{element_1}{element_2}{element_4}
çŠ¶æ€ï¼šå…³ç³»{element_0}ï¼Œä½“åŠ›{element_5}ï¼Œé¥¥é¥¿{element_6}
```

---

### ğŸ’¡ è°ƒè¯•æŠ€å·§ï¼šæ·»åŠ æ³¨é‡Š

åœ¨æ–‡ä»¶ä¸­æ·»åŠ æ³¨é‡Šï¼ˆè™½ç„¶ä¼šè¢«è¯»å–ï¼Œä½†æœ‰åŠ©äºç»´æŠ¤ï¼‰ï¼š

 **æ–‡ä»¶** ï¼š`information/status_base.txt`

```
<!-- 
ç´¢å¼•æ˜ å°„ï¼š
0: å¥½æ„Ÿåº¦
1: æœˆä»½
2: æ—¥æœŸ
3: æ—¬
4: æ—¶æ®µ
5: ä½“åŠ›
6: é¥¥é¥¿åº¦
-->

å½“å‰æ—¶é—´ä¸º{element_1}{element_2}{element_4}ï¼Œ
å…³ç³»çŠ¶æ€ä¸º{element_0}ï¼Œä½“åŠ›{element_5}ï¼Œé¥¥é¥¿ç¨‹åº¦ä¸º{element_6}ã€‚
```

æˆ–è€…åœ¨å•ç‹¬çš„ `README.txt` ä¸­è®°å½•æ˜ å°„è¡¨ã€‚

---

### âš ï¸ ç´¢å¼•è¶Šç•Œé”™è¯¯

å¦‚æœå ä½ç¬¦ç´¢å¼•è¶…å‡ºèŒƒå›´ï¼Œç¨‹åºä¼šæŠ¥é”™ï¼š

```python
IndexError: å ä½ç¬¦ {element_7} è¶…å‡ºå¯ç”¨èŒƒå›´ï¼Œstr_tuple é•¿åº¦ä¸º 7
```

 **åŸå› ** ï¼šæ€»å…±åªæœ‰ 7 ä¸ªç´¢å¼•ï¼ˆ0-6ï¼‰ï¼Œä½†ä½¿ç”¨äº† `{element_7}`

 **è§£å†³** ï¼šæ£€æŸ¥æ€»ç´¢å¼•æ˜ å°„è¡¨ï¼Œç¡®è®¤å¯ç”¨èŒƒå›´ã€‚

---

## Depthï¼ˆæ·±åº¦ç³»ç»Ÿï¼‰

### æ·±åº¦çº§åˆ«è¯´æ˜

* **depth = 0** ï¼šåŸºç¡€å±‚ï¼Œæ€»æ˜¯åŠ è½½
* **depth = 1** ï¼šä¸€çº§æ‰©å±•å±‚ï¼Œåœ¨åŸºç¡€å±‚ä¹‹ååŠ è½½
* **depth = 2+** ï¼šæ›´é«˜çº§åˆ«æ‰©å±•å±‚

### ä½¿ç”¨åœºæ™¯

```json
{
  "simple": {
    "base": {"depth": 0, "file": "base.txt"},
    "detail": {"depth": 1, "file": "detail.txt"}
  }
}
```

ç³»ç»Ÿä¼šæŒ‰æ·±åº¦é¡ºåºæ‹¼æ¥å†…å®¹ï¼š

```
{base.txt å†…å®¹}

{detail.txt å†…å®¹}
```

---

## å®Œæ•´é…ç½®ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šå•å˜é‡é˜¶æ®µç³»ç»Ÿ

```json
{
  "position_0": {
    "simple": {},
    "complex": {
      "affection": {
        "keywords": [],
        "depth": 0,
        "base_file": "information/affection_base.txt",
        "variable_binding": "å¥½æ„Ÿåº¦",
        "variable_binding_method": [0],
        "stages": {
          "part_0": {
            "stage_0": "information/affection_stranger.txt",
            "stage_1": "information/affection_familiar.txt",
            "stage_2": "information/affection_close.txt"
          }
        }
      }
    }
  }
}
```

 **æ–‡ä»¶å†…å®¹** ï¼š

 **affection_base.txt** ï¼š

```
å½“å‰ä¸è§’è‰²çš„å…³ç³»çŠ¶æ€ï¼š{element_0}
```

 **affection_familiar.txt** ï¼š

```
ä½ ä»¬å·²ç»äº’ç›¸è®¤è¯†ï¼Œå¯¹è¯ä¸­å¯ä»¥è¡¨ç°å‡ºç†Ÿæ‚‰æ„Ÿã€‚
```

### ç¤ºä¾‹ 2ï¼šæ—¶é—´ç³»ç»Ÿï¼ˆå¤šç´¢å¼•å¹¶åˆ—ï¼‰

```json
{
  "position_1": {
    "simple": {},
    "complex": {
      "datetime": {
        "keywords": [],
        "depth": 0,
        "base_file": "information/time_base.txt",
        "variable_binding": "æ—¥æœŸ",
        "variable_binding_method": [0, 3],
        "stages": {
          "part_0": {
            "stage_0": "information/month_1.txt",
            "stage_1": "information/month_2.txt",
            "stage_11": "information/month_12.txt"
          },
          "part_1": {
            "stage_0": "information/morning.txt",
            "stage_1": "information/afternoon.txt",
            "stage_2": "information/evening.txt",
            "stage_3": "information/night.txt"
          }
        }
      }
    }
  }
}
```

 **è¯´æ˜** ï¼š

* `variable_binding_method: [0, 3]` ä½¿ç”¨æœˆä»½ï¼ˆç´¢å¼•0ï¼‰å’Œæ—¶æ®µï¼ˆç´¢å¼•3ï¼‰
* è·³è¿‡äº†æ—¥æœŸï¼ˆç´¢å¼•1ï¼‰å’Œæ—¬ï¼ˆç´¢å¼•2ï¼‰

### ç¤ºä¾‹ 3ï¼šå¤šå˜é‡ç»„åˆ

```json
{
  "position_0": {
    "simple": {},
    "complex": {
      "status": {
        "keywords": [],
        "depth": 0,
        "base_file": "information/status_base.txt",
        "variable_binding": ["å¥½æ„Ÿåº¦", "é¥¥é¥¿åº¦"],
        "variable_binding_method": [[0, 1]],
        "stages": {
          "part_0": {
            "stage_0_0": "information/status_low_low.txt",
            "stage_0_1": "information/status_low_mid.txt",
            "stage_1_0": "information/status_mid_low.txt",
            "stage_1_1": "information/status_mid_mid.txt"
          }
        }
      }
    }
  }
}
```

---

## å¸¸è§é”™è¯¯ä¸æ’æŸ¥

### 1. æ–‡ä»¶è·¯å¾„é”™è¯¯

âŒ  **é”™è¯¯** ï¼š

```json
"file": "C:/Users/.../worldview.txt"
```

âœ“  **æ­£ç¡®** ï¼š

```json
"file": "information/worldview.txt"
```

### 2. å˜é‡åä¸åŒ¹é…

âŒ  **é”™è¯¯** ï¼š

```json
"variable_binding": "å¥½æ„Ÿåº¦.æƒ…æ„Ÿé˜¶æ®µ"
```

âœ“  **æ­£ç¡®** ï¼š

```json
"variable_binding": "å¥½æ„Ÿåº¦"
```

### 3. Stage é”®åä¸åŒ¹é…

âŒ  **é”™è¯¯** ï¼ˆå¥½æ„Ÿåº¦=1ï¼Œé¥¥é¥¿åº¦=2ï¼‰ï¼š

```json
"stages": {
  "part_0": {
    "stage_1": "...",
    "stage_2": "..."
  }
}
```

âœ“  **æ­£ç¡®** ï¼š

```json
"stages": {
  "part_0": {
    "stage_1_2": "..."
  }
}
```

### 4. å ä½ç¬¦ç´¢å¼•è¶Šç•Œ

âŒ  **é”™è¯¯** ï¼ˆåªæœ‰ 2 ä¸ªå˜é‡ï¼Œä½¿ç”¨ `{element_2}`ï¼‰ï¼š

```
å½“å‰çŠ¶æ€ï¼š{element_0}, {element_1}, {element_2}
```

âœ“  **æ­£ç¡®** ï¼š

```
å½“å‰çŠ¶æ€ï¼š{element_0}, {element_1}
```

### 5. æ·±åº¦é…ç½®æ··ä¹±

âŒ  **é”™è¯¯** ï¼ˆåŸºç¡€è®¾å®šæ”¾åœ¨é«˜æ·±åº¦ï¼‰ï¼š

```json
"worldview": {"depth": 2, "file": "worldview.txt"}
```

âœ“  **æ­£ç¡®** ï¼š

```json
"worldview": {"depth": 0, "file": "worldview.txt"}
```

---


## å‚è€ƒ

* å˜é‡é…ç½®ï¼šå‚è§ `variables_config_guide.md`
* ä¸–ç•Œä¹¦é…ç½®ï¼šå‚è§ `worldbook_config_guide.md`ï¼ˆå¦‚æœ‰ï¼‰
* ä»£ç å®ç°ï¼šå‚è§ `core/prompt_builder.py`
